(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     17260,        465]
NotebookOptionsPosition[     15097,        398]
NotebookOutlinePosition[     15454,        414]
CellTagsIndexPosition[     15411,        411]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\</home/jeanluc/Projects/articles/topo/ttauto/pubs/systole\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.44276268918027*^9, 3.442762713975093*^9}}],

Cell[BoxData[
 RowBox[{"<<", " ", "PseudoAnosov.m"}]], "Input",
 CellChangeTimes->{
  3.44276975660726*^9, {3.442795192458606*^9, 3.442795195156436*^9}, {
   3.442834863802482*^9, 3.442834864300197*^9}, {3.444932891264221*^9, 
   3.444932903264657*^9}, {3.444963984979224*^9, 3.444963985653634*^9}, {
   3.444964038333988*^9, 3.44496403878162*^9}, {3.445187237847379*^9, 
   3.445187238437856*^9}, {3.445187997363876*^9, 3.445187997810068*^9}}],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<PseudoAnosov`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.445684437294353*^9, 3.445684465609416*^9}, {
  3.445684670481341*^9, 3.445684727750553*^9}}],

Cell[BoxData[
 RowBox[{"Length", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.445684744590438*^9, 3.445684746509261*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Lmax", "=", "40"}], ";"}]], "Input",
 CellChangeTimes->{{3.445096971009833*^9, 3.445096976811664*^9}, {
  3.445097009436874*^9, 3.445097014298607*^9}, {3.445098805533661*^9, 
  3.445098808252107*^9}, {3.445113188022419*^9, 3.445113188060295*^9}, {
  3.445181807573189*^9, 3.445181807635938*^9}, {3.445188115696583*^9, 
  3.445188116079084*^9}}],

Cell[BoxData[
 RowBox[{"?", "StratumOrbits"}]], "Input",
 CellChangeTimes->{3.445268782852496*^9, 3.445529020885277*^9}],

Cell[BoxData[
 RowBox[{"?", "LefschetzCombine"}]], "Input",
 CellChangeTimes->{3.445114472741229*^9}],

Cell["\<\
The \"expert\" functions are not imported into the Global context, and must  \
be scoped explicitly:\
\>", "Text",
 CellChangeTimes->{{3.445699052083143*^9, 3.4456990740795717`*^9}, {
  3.445699253760557*^9, 3.445699261939457*^9}}],

Cell[BoxData[
 RowBox[{"?", "PseudoAnosov`Lefschetz`Orbits`SingularStratum"}]], "Input",
 CellChangeTimes->{{3.445167874231023*^9, 3.445167879277165*^9}, {
  3.445693359154546*^9, 3.445693399296465*^9}, {3.445698226422151*^9, 
  3.4456982354257803`*^9}}],

Cell[BoxData[
 RowBox[{"?", "PseudoAnosov`Lefschetz`Orbits`Regular"}]], "Input",
 CellChangeTimes->{3.445699026871324*^9}],

Cell[BoxData[
 RowBox[{"P", "=", 
  RowBox[{"1", "-", 
   SuperscriptBox["x", "2"], "+", 
   SuperscriptBox["x", "3"], "-", 
   SuperscriptBox["x", "4"], "+", 
   SuperscriptBox["x", "6"]}]}]], "Input",
 CellChangeTimes->{{3.4450771044355993`*^9, 3.44507712304354*^9}, 
   3.445082110269047*^9, 3.4450823130927677`*^9, {3.445617260883423*^9, 
   3.445617270913923*^9}}],

Cell[BoxData[
 RowBox[{"L", "=", 
  RowBox[{"LefschetzNumbers", "[", 
   RowBox[{"P", ",", 
    RowBox[{"{", "Lmax", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.445077037140609*^9, 3.44507704643116*^9}, 
   3.445077131768519*^9, {3.445077161832221*^9, 3.445077235962675*^9}, {
   3.445077519546238*^9, 3.4450775200297823`*^9}, 3.445096992187507*^9, {
   3.445098813150831*^9, 3.445098813421686*^9}, {3.445270322112792*^9, 
   3.445270322251102*^9}}],

Cell["\<\
There are two possibilities with distinct Lefschetz numbers for the stratum \
with a single degree 8 singularity :\
\>", "Text",
 CellChangeTimes->{{3.445113118488566*^9, 3.445113134172031*^9}, 
   3.445113769032686*^9, {3.445699385417727*^9, 3.4456993861005707`*^9}}],

Cell[BoxData[
 RowBox[{"Ls8", "=", 
  RowBox[{"PseudoAnosov`Lefschetz`Orbits`SingularStratum", "[", 
   RowBox[{"{", "8", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.445167019962783*^9, 3.445167028087212*^9}, {
   3.445530198138095*^9, 3.445530203275811*^9}, 3.445698834169118*^9, {
   3.445698926543291*^9, 3.445698945281642*^9}}],

Cell[BoxData[
 RowBox[{"Length", "[", "Ls8", "]"}]], "Input",
 CellChangeTimes->{{3.445698998954645*^9, 3.445699000611972*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PseudoAnosov`Lefschetz`Orbits`Regular", "[", 
    RowBox[{"LefschetzCombine", "[", 
     RowBox[{"L", ",", 
      RowBox[{
       RowBox[{"-", "SingularitiesLefschetzBlock"}], "/.", "#"}], ",", 
      RowBox[{"Length", "[", "L", "]"}]}], "]"}], "]"}], "&"}], "/@", 
  "Ls8"}]], "Input",
 CellChangeTimes->{{3.4451111719223537`*^9, 3.445111179866075*^9}, 
   3.44511177729907*^9, {3.4451118293888197`*^9, 3.4451118314561853`*^9}, {
   3.4451120542325983`*^9, 3.445112056733639*^9}, {3.4451123970134697`*^9, 
   3.44511240244541*^9}, {3.445112960931096*^9, 3.4451129620822153`*^9}, {
   3.445113059343555*^9, 3.445113061027108*^9}, 3.445163893042965*^9, {
   3.445210642231166*^9, 3.445210647087792*^9}, {3.445529812802593*^9, 
   3.4455298413194647`*^9}, {3.4455299126924973`*^9, 3.445529915381309*^9}, {
   3.445530210358127*^9, 3.445530225141077*^9}, {3.445698843700989*^9, 
   3.445698909326202*^9}}],

Cell["\<\
There are twenty possibilities with distinct Lefschetz numbers for the \
stratum with four degree 2 singularities :\
\>", "Text",
 CellChangeTimes->{{3.445113118488566*^9, 3.4451131563640213`*^9}, {
  3.445113532393447*^9, 3.44511353264669*^9}, {3.445113754072248*^9, 
  3.445113759607006*^9}, {3.4451670925069304`*^9, 3.445167093031109*^9}, {
  3.445210674100709*^9, 3.445210674392857*^9}, {3.445456832041335*^9, 
  3.445456833079013*^9}, {3.44569899061838*^9, 3.44569899133427*^9}}],

Cell[BoxData[
 RowBox[{"Ls2222", "=", 
  RowBox[{"PseudoAnosov`Lefschetz`Orbits`SingularStratum", "[", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.445167076514306*^9, 3.445167109111227*^9}, {
  3.445210721234355*^9, 3.445210722464394*^9}, {3.445698865345152*^9, 
  3.445698869088441*^9}, {3.445698974573413*^9, 3.445698977587483*^9}}],

Cell[BoxData[
 RowBox[{"Length", "[", "Ls2222", "]"}]], "Input",
 CellChangeTimes->{{3.4452106646419687`*^9, 3.445210669565852*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PseudoAnosov`Lefschetz`Orbits`Regular", "[", 
    RowBox[{"LefschetzCombine", "[", 
     RowBox[{"L", ",", 
      RowBox[{
       RowBox[{"-", "SingularitiesLefschetzBlock"}], "/.", "#"}], ",", 
      RowBox[{"Length", "[", "L", "]"}]}], "]"}], "]"}], "&"}], "/@", 
  "Ls2222"}]], "Input",
 CellChangeTimes->{{3.4451111719223537`*^9, 3.445111179866075*^9}, 
   3.44511177729907*^9, {3.4451118293888197`*^9, 3.4451118314561853`*^9}, {
   3.4451120542325983`*^9, 3.445112056733639*^9}, {3.4451123970134697`*^9, 
   3.44511240244541*^9}, {3.445112960931096*^9, 3.4451129620822153`*^9}, 
   3.445163899588644*^9, {3.445210693712455*^9, 3.445210695640087*^9}, {
   3.445529965996674*^9, 3.44552996770107*^9}, 3.445699014365795*^9}],

Cell["\<\
A more complicated test : the minimizing polynomial for genus 3 could in \
principle also live on (4,2,2) with a negative Perron root.  Is this really \
possible?  Let's find out!\
\>", "Text",
 CellChangeTimes->{{3.44516320332894*^9, 3.445163249796061*^9}, {
  3.445699396065069*^9, 3.445699396664909*^9}}],

Cell[BoxData[{
 RowBox[{"P", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "-", "x", "-", 
     SuperscriptBox["x", "3"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     SuperscriptBox["x", "2"], "-", 
     SuperscriptBox["x", "3"]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"L", "=", 
  RowBox[{"LefschetzNumbers", "[", 
   RowBox[{"P", ",", 
    RowBox[{"{", "Lmax", "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.445163607474118*^9, 3.445163618785153*^9}, {
   3.445270337436841*^9, 3.445270337612686*^9}, 3.445699404237599*^9}],

Cell[BoxData[
 RowBox[{"Ls422", "=", 
  RowBox[{"PseudoAnosov`Lefschetz`Orbits`SingularStratum", "[", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2", ",", "2"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.445163262736403*^9, 3.445163273704485*^9}, {
   3.4451633480121*^9, 3.4451633996287394`*^9}, {3.445163447920989*^9, 
   3.445163508886838*^9}, {3.445163550194088*^9, 3.44516356381563*^9}, 
   3.4451638442851763`*^9, {3.445164140162992*^9, 3.445164140318623*^9}, {
   3.4451671261467113`*^9, 3.445167130182095*^9}, {3.44521076425021*^9, 
   3.445210775926799*^9}, 3.445699292418888*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PseudoAnosov`Lefschetz`Orbits`Regular", "[", 
    RowBox[{"LefschetzCombine", "[", 
     RowBox[{"L", ",", 
      RowBox[{
       RowBox[{"-", "SingularitiesLefschetzBlock"}], "/.", "#"}], ",", 
      RowBox[{"Length", "[", "L", "]"}]}], "]"}], "]"}], "&"}], "/@", 
  RowBox[{"PseudoAnosov`Lefschetz`Orbits`SingularStratum", "[", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2", ",", "2"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.445163640971836*^9, 3.445163641976819*^9}, {
   3.4451637422621307`*^9, 3.4451637922370853`*^9}, {3.445163853208867*^9, 
   3.445163854772801*^9}, {3.445167576868862*^9, 3.4451675853844137`*^9}, {
   3.445170535359579*^9, 3.445170575150674*^9}, 3.445170735972846*^9, {
   3.445210793569532*^9, 3.445210795861964*^9}, {3.445529988115756*^9, 
   3.445529989315275*^9}, 3.445699294526627*^9, 3.4456993402364197`*^9}],

Cell["So it seems to work on (4,2,2)!", "Text",
 CellChangeTimes->{{3.4451641829424257`*^9, 3.445164194201044*^9}, {
  3.445435178963036*^9, 3.4454351826461*^9}}],

Cell["\<\
Let' s show that Lehmer' s polynomial works on (16) and (4, 4, 4, 4) :\
\>", "Text",
 CellChangeTimes->{{3.4455299959524097`*^9, 3.445529998770974*^9}}],

Cell[BoxData[
 RowBox[{"P", "=", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "10"], "+", 
    SuperscriptBox["x", "9"], "-", 
    SuperscriptBox["x", "7"], "-", 
    SuperscriptBox["x", "6"], "-", 
    SuperscriptBox["x", "5"], "-", 
    SuperscriptBox["x", "4"], "-", 
    SuperscriptBox["x", "3"], "+", "x", "+", "1"}], "/.", 
   RowBox[{"x", "\[Rule]", 
    RowBox[{"-", "x"}]}]}]}]], "Input",
 CellChangeTimes->{{3.445164949921672*^9, 3.44516499014464*^9}, {
  3.445270344075981*^9, 3.445270344267642*^9}, {3.445699494441472*^9, 
  3.445699494721122*^9}}],

Cell[BoxData[
 RowBox[{"StratumOrbits", "[", 
  RowBox[{
   RowBox[{"{", "16", "}"}], ",", "P"}], "]"}]], "Input",
 CellChangeTimes->{{3.445699476784638*^9, 3.4456994854300823`*^9}}],

Cell[BoxData[
 RowBox[{"LefschetzNumbersTestQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "4"}], "}"}], ",", "P"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.445263069124029*^9, 3.445263109665798*^9}, {
  3.445270357498455*^9, 3.445270357674363*^9}, {3.445354735435629*^9, 
  3.445354737177922*^9}, {3.445354771802831*^9, 3.445354772680916*^9}, {
  3.445354815545674*^9, 3.445354865270287*^9}, {3.445354912535009*^9, 
  3.445354928886656*^9}, {3.44535507630662*^9, 3.445355076768896*^9}, {
  3.445363917075345*^9, 3.445363918656902*^9}}],

Cell[BoxData[
 RowBox[{"StratumOrbits", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "4"}], "}"}], ",", "P"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.44543166518948*^9, 3.44543167833777*^9}, 
   3.445529026712325*^9}],

Cell[BoxData[
 RowBox[{"Scan", "[", 
  RowBox[{"StratumOrbitsTable", ",", "%"}], "]"}]], "Input",
 CellChangeTimes->{{3.44562628912439*^9, 3.445626289828452*^9}}],

Cell["So works on (4, 4, 4, 4)!", "Text",
 CellChangeTimes->{{3.445167636675413*^9, 3.445167645804492*^9}, {
  3.445210887072342*^9, 3.4452109336379223`*^9}}],

Cell["Now for some tests with positive Perron root :", "Text",
 CellChangeTimes->{{3.4452114406122923`*^9, 3.445211447431795*^9}}],

Cell["\<\
This polynomial gives the systole on (4, 2, 2), so it should work :\
\>", "Text",
 CellChangeTimes->{{3.445211451719212*^9, 3.4452114662173243`*^9}}],

Cell[BoxData[
 RowBox[{"P", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x", "+", 
     SuperscriptBox["x", "3"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     SuperscriptBox["x", "2"], "+", 
     SuperscriptBox["x", "3"]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.445177979718646*^9, 3.445178012054102*^9}}],

Cell[BoxData[
 RowBox[{"StratumOrbits", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "2", ",", "2"}], "}"}], ",", "P"}], "]"}]], "Input",
 CellChangeTimes->{{3.445699538316905*^9, 3.445699545752672*^9}}],

Cell[BoxData[
 RowBox[{"Scan", "[", 
  RowBox[{"StratumOrbitsTable", ",", "%"}], "]"}]], "Input"],

Cell["Also works with negative Perron root :", "Text",
 CellChangeTimes->{{3.445699567098681*^9, 3.4456995752924833`*^9}}],

Cell[BoxData[
 RowBox[{"StratumOrbits", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"P", "/.", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", "x"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4455274409934673`*^9, 3.4455274702022877`*^9}, {
   3.4455277687343616`*^9, 3.445527769966703*^9}, 3.4455278203417387`*^9, {
   3.445528060696052*^9, 3.445528060943544*^9}, 3.4455289979165783`*^9, {
   3.4455291502470303`*^9, 3.4455291504114447`*^9}, {3.4455300589168777`*^9, 
   3.44553005972418*^9}, {3.445699559364259*^9, 3.44569956049481*^9}}],

Cell[BoxData[
 RowBox[{"Scan", "[", 
  RowBox[{"StratumOrbitsTable", ",", "%"}], "]"}]], "Input"],

Cell["Tests for strata with \"degenerate\" regular orbits :", "Text",
 CellChangeTimes->{{3.445268633503543*^9, 3.445268646712534*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"1", "+", "x", "-", 
    SuperscriptBox["x", "2"], "-", 
    SuperscriptBox["x", "3"], "-", 
    SuperscriptBox["x", "4"], "+", 
    SuperscriptBox["x", "5"], "+", 
    SuperscriptBox["x", "6"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4455294213558407`*^9, 3.445529426759942*^9}, {
  3.44561747860598*^9, 3.445617484362799*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"so", "=", 
   RowBox[{"StratumOrbits", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}], ",", "P"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.4455290189648*^9, {3.4455292936500473`*^9, 3.445529294645813*^9}, {
   3.445617492253403*^9, 3.44561749396312*^9}, 3.445617589802402*^9, 
   3.44562639027593*^9}],

Cell[BoxData[
 RowBox[{"Scan", "[", 
  RowBox[{"StratumOrbitsTable", ",", "so"}], "]"}]], "Input",
 CellChangeTimes->{{3.445626178200443*^9, 3.445626202902162*^9}}],

Cell[BoxData[
 RowBox[{"Subtract", "@@", 
  RowBox[{"(", 
   RowBox[{"RegularOrbits", "/.", "so"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.445529352146955*^9, 3.4455294102730093`*^9}}],

Cell[BoxData[
 RowBox[{"Subtract", "@@", 
  RowBox[{"(", 
   RowBox[{"SingularitiesLefschetzBlock", "/.", "so"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.4455294939575043`*^9, 3.4455294987483*^9}}],

Cell[BoxData[
 RowBox[{"LefschetzNumbers", "[", 
  RowBox[{"P", ",", 
   RowBox[{"{", "20", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.445270369898392*^9, 3.445270370154353*^9}, 
   3.445529438061593*^9}]
},
WindowSize->{892, 868},
WindowMargins->{{0, Automatic}, {Automatic, 25}},
ShowSelection->True,
FrontEndVersion->"7.0 for Linux x86 (64-bit) (November 11, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 199, 4, 32, "Input"],
Cell[602, 19, 444, 7, 32, "Input"],
Cell[1049, 28, 194, 3, 32, "Input"],
Cell[1246, 33, 125, 2, 32, "Input"],
Cell[1374, 37, 379, 7, 32, "Input"],
Cell[1756, 46, 120, 2, 32, "Input"],
Cell[1879, 50, 101, 2, 32, "Input"],
Cell[1983, 54, 241, 5, 31, "Text"],
Cell[2227, 61, 254, 4, 32, "Input"],
Cell[2484, 67, 122, 2, 32, "Input"],
Cell[2609, 71, 369, 9, 32, "Input"],
Cell[2981, 82, 455, 9, 32, "Input"],
Cell[3439, 93, 278, 5, 31, "Text"],
Cell[3720, 100, 335, 6, 32, "Input"],
Cell[4058, 108, 127, 2, 32, "Input"],
Cell[4188, 112, 949, 18, 55, "Input"],
Cell[5140, 132, 494, 8, 31, "Text"],
Cell[5637, 142, 405, 7, 32, "Input"],
Cell[6045, 151, 132, 2, 32, "Input"],
Cell[6180, 155, 773, 15, 55, "Input"],
Cell[6956, 172, 317, 6, 51, "Text"],
Cell[7276, 180, 598, 17, 55, "Input"],
Cell[7877, 199, 592, 10, 32, "Input"],
Cell[8472, 211, 895, 17, 77, "Input"],
Cell[9370, 230, 162, 2, 31, "Text"],
Cell[9535, 234, 162, 3, 31, "Text"],
Cell[9700, 239, 563, 15, 32, "Input"],
Cell[10266, 256, 182, 4, 32, "Input"],
Cell[10451, 262, 571, 11, 32, "Input"],
Cell[11025, 275, 251, 7, 32, "Input"],
Cell[11279, 284, 162, 3, 32, "Input"],
Cell[11444, 289, 158, 2, 31, "Text"],
Cell[11605, 293, 130, 1, 31, "Text"],
Cell[11738, 296, 159, 3, 31, "Text"],
Cell[11900, 301, 379, 12, 32, "Input"],
Cell[12282, 315, 214, 5, 32, "Input"],
Cell[12499, 322, 97, 2, 32, "Input"],
Cell[12599, 326, 122, 1, 31, "Text"],
Cell[12724, 329, 595, 12, 32, "Input"],
Cell[13322, 343, 97, 2, 32, "Input"],
Cell[13422, 347, 135, 1, 31, "Text"],
Cell[13560, 350, 387, 10, 32, "Input"],
Cell[13950, 362, 374, 10, 32, "Input"],
Cell[14327, 374, 164, 3, 32, "Input"],
Cell[14494, 379, 186, 4, 32, "Input"],
Cell[14683, 385, 198, 4, 32, "Input"],
Cell[14884, 391, 209, 5, 32, "Input"]
}
]
*)

