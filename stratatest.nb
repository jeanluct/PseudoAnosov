(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     35535,        991]
NotebookOptionsPosition[     32896,        904]
NotebookOutlinePosition[     33255,        920]
CellTagsIndexPosition[     33212,        917]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Automated Elimination of Strata", "Subtitle",
 CellChangeTimes->{{3.444843521656591*^9, 3.444843530989089*^9}}],

Cell[CellGroupData[{

Cell["Initialization", "Section",
 CellChangeTimes->{{3.444822455534054*^9, 3.444822457592043*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\</home/jeanluc/Projects/articles/topo/ttauto/pubs/systole\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.44276268918027*^9, 3.442762713975093*^9}}],

Cell[BoxData[
 RowBox[{"<<", " ", "PseudoAnosov.m"}]], "Input",
 CellChangeTimes->{
  3.44276975660726*^9, {3.442795192458606*^9, 3.442795195156436*^9}, {
   3.442834863802482*^9, 3.442834864300197*^9}, {3.444932891264221*^9, 
   3.444932903264657*^9}, {3.444963984979224*^9, 3.444963985653634*^9}, {
   3.444964038333988*^9, 3.44496403878162*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"scoretable", "[", "t_", "]"}], " ", ":=", " ", 
  RowBox[{"Framed", "[", 
   RowBox[{
    RowBox[{"TableForm", "[", 
     RowBox[{"Tally", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"StringCases", "[", 
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
            "RegularExpression", "[", "\"\<^[A-Za-z_0-9()]+(?=:?)\>\"", 
             "]"}]}], "]"}], " ", "&"}], ")"}], " ", "/@", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"t", ",", " ", "1"}], "]"}]}], "]"}], "]"}], "]"}], ",", " ", 
    RowBox[{"Background", " ", "->", " ", "LightRed"}], ",", " ", 
    RowBox[{"FrameStyle", " ", "->", " ", "None"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.444819312081152*^9, 3.444819328945385*^9}, {
  3.444843635631744*^9, 3.444843637588901*^9}, {3.444937711386949*^9, 
  3.444937744496416*^9}, {3.4449410346795273`*^9, 3.444941035081147*^9}, {
  3.445019865983944*^9, 3.445019869198443*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"resultstable", "[", 
   RowBox[{"P_", ",", " ", "s_", ",", " ", "t_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "r", "}"}], ",", " ", 
    RowBox[{"TabView", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{
               RowBox[{"t", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "All", ",", "2"}], "]"}], "]"}], ",", 
               "\"\<Allowable\>\""}], "]"}], ">", "0"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "k", "]"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}],
             ",", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "k", "]"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
             "]"}]}], " ", "]"}], "->", " ", 
          RowBox[{"Column", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Framed", "[", 
              RowBox[{
               RowBox[{
               "P", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"Background", "\[Rule]", "White"}], ",", 
               RowBox[{"FrameStyle", " ", "->", " ", "None"}]}], "]"}], ",", 
             RowBox[{"Grid", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"s", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r", " ", "=", " ", 
                    RowBox[{"t", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", " ", "j", ",", " ", "2"}], "]"}], 
                    "]"}]}], ")"}], " ", "\[LongEqual]", " ", 
                    "\"\<Allowable\>\""}], ",", " ", 
                    RowBox[{"Style", "[", 
                    RowBox[{"r", ",", " ", "Bold"}], "]"}], ",", " ", "r"}], 
                    "]"}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", " ", 
                   RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], "]"}], ",", 
               " ", 
               RowBox[{"Alignment", " ", "->", " ", "Left"}]}], "]"}]}], 
            "}"}], "]"}]}], "}"}], "\[IndentingNewLine]", ",", " ", 
        RowBox[{"{", 
         RowBox[{"k", ",", " ", 
          RowBox[{"Length", "[", "P", "]"}]}], "}"}]}], "]"}], "]"}], "]"}]}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.4448185769134912`*^9, 3.444818620796167*^9}, {
   3.444819283288286*^9, 3.4448192872337027`*^9}, {3.444819511451982*^9, 
   3.444819530445219*^9}, {3.44482141856257*^9, 3.444821507410432*^9}, {
   3.444843643961825*^9, 3.4448436473891363`*^9}, 3.4448458017864237`*^9, {
   3.4448458332968273`*^9, 3.444845865990212*^9}, {3.4448458980759974`*^9, 
   3.444845916299274*^9}, {3.444846104899811*^9, 3.4448461088009663`*^9}, {
   3.444846140314373*^9, 3.444846148298642*^9}, {3.444846384645055*^9, 
   3.444846483272315*^9}, {3.444846515046485*^9, 3.444846516865363*^9}, {
   3.44484671279666*^9, 3.444846715800951*^9}, 3.444941387998064*^9, 
   3.445019903219822*^9, {3.445544185857185*^9, 3.445544309885445*^9}, {
   3.445562707105281*^9, 3.445562733244471*^9}, {3.4455627798194227`*^9, 
   3.4455628066025*^9}, {3.445562887496608*^9, 3.445562892954916*^9}, {
   3.445562956674582*^9, 3.445562958661077*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"allowablestrata", "[", 
   RowBox[{"P_", ",", " ", "s_", ",", " ", "t_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "st", "}"}], ",", " ", 
    RowBox[{"Framed", "[", 
     RowBox[{
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"P", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", " ", 
            RowBox[{"Column", "[", 
             RowBox[{
              RowBox[{"st", " ", "=", " ", 
               RowBox[{"Pick", "[", 
                RowBox[{"s", ",", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "&"}], ")"}], " ", "/@",
                   " ", 
                  RowBox[{"t", "[", 
                   RowBox[{"[", "k", "]"}], "]"}]}]}], "]"}]}], ";", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"st", " ", "\[LongEqual]", " ", 
                 RowBox[{"{", "}"}]}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<none\>\"", ",", " ", "Italic"}], "]"}], "}"}], 
                ",", " ", "st"}], "]"}]}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"k", ",", " ", 
            RowBox[{"Length", "[", "t", "]"}]}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"Spacings", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"2", ",", " ", "1"}], "}"}]}], ",", " ", 
        RowBox[{"Alignment", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"Left", ",", " ", "Top"}], "}"}]}]}], "]"}], ",", " ", 
      RowBox[{"Background", " ", "->", " ", "LightGreen"}], ",", " ", 
      RowBox[{"FrameStyle", " ", "->", " ", "None"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.444820355590103*^9, 3.4448203671205463`*^9}, {
   3.444820403543923*^9, 3.444820404080968*^9}, {3.444820445897664*^9, 
   3.444820458293314*^9}, {3.444820502186372*^9, 3.444820503315258*^9}, {
   3.444820570017824*^9, 3.444820606958001*^9}, {3.4448206589467173`*^9, 
   3.444820694121529*^9}, {3.4448207554017687`*^9, 3.444820781330755*^9}, {
   3.444820815050661*^9, 3.444820850197412*^9}, {3.444821217469034*^9, 
   3.444821311379854*^9}, {3.444821353175932*^9, 3.444821359218094*^9}, {
   3.4448220467555428`*^9, 3.44482206304154*^9}, {3.444822096535431*^9, 
   3.4448221027539663`*^9}, 3.4448222562855597`*^9, {3.444822288997514*^9, 
   3.44482228922269*^9}, {3.4448436527866173`*^9, 3.444843660104763*^9}, {
   3.444846020689087*^9, 3.444846079973425*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fulltreatment", "[", 
   RowBox[{"P_", ",", " ", "s_", ",", " ", 
    RowBox[{"opts", " ", ":", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", " ", "rt", ",", "opts2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"opts2", "=", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "opts", "}"}], ",", " ", 
        RowBox[{"Options", "[", "LefschetzNumbersTestQ", "]"}]}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"t", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LefschetzNumbersTestQ", "[", 
            RowBox[{"#1", ",", " ", 
             RowBox[{"P", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "  ", 
             RowBox[{"GiveReasonForRejection", " ", "->", " ", "True"}], ",", 
             " ", 
             RowBox[{"Sequence", "@@", "opts2"}]}], "]"}], " ", "&"}], ")"}], 
         " ", "/@", " ", "s"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"k", ",", " ", 
          RowBox[{"Length", "[", "P", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "ResultsByPolynomial", "]"}], ",", " ", 
       RowBox[{"rt", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"allowablestrata", "[", 
           RowBox[{"P", ",", " ", "s", ",", " ", "t"}], "]"}], ",", " ", 
          RowBox[{"resultstable", "[", 
           RowBox[{"P", ",", " ", "s", ",", " ", "t"}], "]"}], ",", " ", 
          RowBox[{"scoretable", "[", "t", "]"}]}], "}"}]}], ",", " ", 
       RowBox[{"rt", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"allowablestrata", "[", 
           RowBox[{"P", ",", " ", "s", ",", " ", "t"}], "]"}], ",", " ", 
          RowBox[{"scoretable", "[", "t", "]"}]}], "}"}]}]}], "]"}], ";", " ", 
     RowBox[{"Column", "[", 
      RowBox[{"rt", ",", " ", "Left", ",", " ", "1.5"}], "]"}]}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ResultsByPolynomial", "::", "\"\<usage\>\""}], " ", "=", " ", 
   "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "fulltreatment", "]"}], " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ResultsByPolynomial", " ", "->", " ", "True"}], "}"}], ",", 
     " ", 
     RowBox[{"Options", "[", "LefschetzNumbersTestQ", "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.444822464200306*^9, 3.444822507246949*^9}, {
   3.444822541086905*^9, 3.4448226592879267`*^9}, {3.444822741521229*^9, 
   3.44482276111549*^9}, 3.444822921069412*^9, {3.444823372623472*^9, 
   3.444823401899185*^9}, {3.444823437366678*^9, 3.444823465633163*^9}, {
   3.444823507377571*^9, 3.444823624530134*^9}, {3.4448236621401463`*^9, 
   3.444823682577997*^9}, {3.444823729028623*^9, 3.4448237625505743`*^9}, {
   3.444843664825879*^9, 3.444843667698547*^9}, {3.4448437239961987`*^9, 
   3.444843780694531*^9}, {3.444939498814538*^9, 3.444939503942596*^9}, {
   3.444940744967371*^9, 3.444940749489359*^9}, {3.445457511685585*^9, 
   3.445457511962632*^9}, {3.4457746289210243`*^9, 3.445774766829644*^9}, {
   3.4457748019317913`*^9, 3.445774849454896*^9}, {3.445774884806369*^9, 
   3.445774888851815*^9}, {3.445774936837509*^9, 3.445774939099331*^9}, 
   3.44577595858156*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Test strata", "Section",
 CellChangeTimes->{{3.44482449050348*^9, 3.4448244907408123`*^9}, {
  3.4448420110326643`*^9, 3.444842032431275*^9}}],

Cell[CellGroupData[{

Cell["genus 3", "Subsection",
 CellChangeTimes->{{3.4448420185167427`*^9, 3.444842028138886*^9}, {
   3.444842857765862*^9, 3.444842863459113*^9}, {3.444844127645734*^9, 
   3.444844138316798*^9}, 3.444844170191144*^9}],

Cell[CellGroupData[{

Cell["Table 1 in systole paper", "Subsubsection",
 CellChangeTimes->{{3.44484417891229*^9, 3.4448442039642467`*^9}}],

Cell["\<\
For genus 3, the first two elements of P are the cases that should be \
eliminated.  For comparison, the last is a \"good\" (valid) polynomial, the \
minimizer for genus 3, living on stratum (4,2,2).\
\>", "Text",
 CellChangeTimes->{{3.444733516061398*^9, 3.444733523669318*^9}, {
  3.44484209451901*^9, 3.444842110013475*^9}}],

Cell[BoxData[
 RowBox[{"P", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "3"], "-", "x", "-", "1"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "3"], "+", 
       SuperscriptBox["x", "2"], "-", "1"}], ")"}]}], ",", 
    RowBox[{
     SuperscriptBox["x", "6"], "-", 
     SuperscriptBox["x", "4"], "-", 
     SuperscriptBox["x", "3"], "-", 
     SuperscriptBox["x", "2"], "+", "1"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x", "+", 
       SuperscriptBox["x", "3"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["x", "3"]}], ")"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.444329406419272*^9, 3.444329421438912*^9}, {
  3.4443308705736*^9, 3.444330890029245*^9}, {3.444842069303287*^9, 
  3.44484206971275*^9}}],

Cell[BoxData[{
 RowBox[{"s", "=", 
  RowBox[{"OrientableStrataList", "[", "3", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "s", "]"}]}], "Input",
 CellChangeTimes->{{3.444330656873543*^9, 3.444330668509593*^9}, {
  3.4443308208594627`*^9, 3.444330822677339*^9}, {3.444656731018258*^9, 
  3.444656731320759*^9}, {3.444657027474447*^9, 3.444657027888639*^9}, {
  3.444657535652937*^9, 3.444657536131111*^9}, {3.444734946296379*^9, 
  3.444734946617485*^9}}],

Cell["\<\
For positive dilatation, can eliminate everything but the appropriate, (4, 2, \
2) stratum for Pgood :\
\>", "Text",
 CellChangeTimes->{{3.4447339166061974`*^9, 3.4447339365811853`*^9}, {
  3.4455629638682203`*^9, 3.445562964956736*^9}}],

Cell[BoxData[
 RowBox[{"fulltreatment", "[", 
  RowBox[{"P", ",", "s", ",", 
   RowBox[{"MaxLefschetz", "\[Rule]", "100"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4448226368816347`*^9, 3.444822672420779*^9}, {
   3.444823632138281*^9, 3.4448236378309803`*^9}, 3.4448237874949093`*^9, {
   3.4457744795508003`*^9, 3.445774483299876*^9}}],

Cell["\<\
For negative dilatation, the first two polynomials should be eliminated (not \
sure about the third one) :\
\>", "Text",
 CellChangeTimes->{{3.444733948279311*^9, 3.444733971321538*^9}}],

Cell[BoxData[
 RowBox[{"fulltreatment", "[", 
  RowBox[{
   RowBox[{"P", "/.", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", "x"}]}]}], ",", "s"}], "]"}]], "Input",
 CellChangeTimes->{{3.4448228474725513`*^9, 3.444822848669339*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Table 2 in systole paper \[LongDash] nonorientable case in genus 2\
\>", "Subsubsection",
 CellChangeTimes->{{3.4448442308722057`*^9, 3.444844232087859*^9}}],

Cell["This requires testing polynomials for genus 3.", "Text",
 CellChangeTimes->{{3.444844237887794*^9, 3.444844248351185*^9}}],

Cell[BoxData[
 RowBox[{"P", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "x", "-", 
       SuperscriptBox["x", "3"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"], "-", 
       SuperscriptBox["x", "3"]}], ")"}]}], ",", 
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"], "-", 
     SuperscriptBox["x", "3"], "-", 
     SuperscriptBox["x", "4"], "+", 
     SuperscriptBox["x", "6"]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x", "+", 
       SuperscriptBox["x", "3"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["x", "3"]}], ")"}]}], ",", 
    RowBox[{"1", "-", "x", "-", 
     SuperscriptBox["x", "3"], "-", 
     SuperscriptBox["x", "5"], "+", 
     SuperscriptBox["x", "6"]}], ",", 
    RowBox[{"1", "-", "x", "-", 
     SuperscriptBox["x", "2"], "+", 
     SuperscriptBox["x", "3"], "-", 
     SuperscriptBox["x", "4"], "-", 
     SuperscriptBox["x", "5"], "+", 
     SuperscriptBox["x", "6"]}], ",", 
    RowBox[{"1", "-", 
     RowBox[{"2", " ", "x"}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"5", " ", 
      SuperscriptBox["x", "3"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["x", "4"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "5"]}], "+", 
     SuperscriptBox["x", "6"]}], ",", 
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "3"]}], "-", 
     SuperscriptBox["x", "4"], "+", 
     SuperscriptBox["x", "6"]}], ",", 
    RowBox[{"1", "-", 
     RowBox[{"2", " ", "x"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["x", "3"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "4"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "5"]}], "+", 
     SuperscriptBox["x", "6"]}], ",", 
    RowBox[{"1", "-", "x", "+", 
     SuperscriptBox["x", "2"], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["x", "3"]}], "+", 
     SuperscriptBox["x", "4"], "-", 
     SuperscriptBox["x", "5"], "+", 
     SuperscriptBox["x", "6"]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.444842744558538*^9, 3.4448427448092737`*^9}}],

Cell[BoxData[{
 RowBox[{"s", "=", 
  RowBox[{"OrientableStrataList", "[", "3", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "s", "]"}]}], "Input",
 CellChangeTimes->{{3.444842796798962*^9, 3.444842800364314*^9}}],

Cell[BoxData[
 RowBox[{"fulltreatment", "[", 
  RowBox[{"P", ",", "s"}], "]"}]], "Input",
 CellChangeTimes->{
  3.444842999418845*^9, {3.444845980857987*^9, 3.444845989640822*^9}}],

Cell[BoxData[
 RowBox[{"fulltreatment", "[", 
  RowBox[{
   RowBox[{"P", "/.", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", "x"}]}]}], ",", "s"}], "]"}]], "Input",
 CellChangeTimes->{{3.4448428417107286`*^9, 3.444842842937825*^9}, 
   3.444843009634226*^9, 3.444845993809411*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["genus 4", "Subsection",
 CellChangeTimes->{{3.4448420185167427`*^9, 3.444842028138886*^9}, {
   3.444842247720079*^9, 3.444842247787632*^9}, {3.444842919562825*^9, 
   3.444842922699901*^9}, 3.444844143624495*^9, 3.444844270092781*^9}],

Cell[CellGroupData[{

Cell["Table 4 in systole paper", "Subsubsection",
 CellChangeTimes->{{3.444844278530365*^9, 3.444844279571*^9}}],

Cell[BoxData[
 RowBox[{"P", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"1", "+", 
     RowBox[{"3", " ", "x"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["x", "3"]}], "-", 
     RowBox[{"8", " ", 
      SuperscriptBox["x", "4"]}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["x", "5"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "6"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["x", "7"]}], "+", 
     SuperscriptBox["x", "8"]}], ",", 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", "x"}], "+", 
     SuperscriptBox["x", "2"], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["x", "3"]}], "-", 
     RowBox[{"5", " ", 
      SuperscriptBox["x", "4"]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["x", "5"]}], "+", 
     SuperscriptBox["x", "6"], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "7"]}], "+", 
     SuperscriptBox["x", "8"]}], ",", 
    RowBox[{"1", "-", "x", "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "2"]}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["x", "4"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "6"]}], "-", 
     SuperscriptBox["x", "7"], "+", 
     SuperscriptBox["x", "8"]}], ",", 
    RowBox[{"1", "+", "x", "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "3"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "4"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "5"]}], "+", 
     SuperscriptBox["x", "7"], "+", 
     SuperscriptBox["x", "8"]}], ",", 
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"], "-", 
     SuperscriptBox["x", "3"], "+", 
     SuperscriptBox["x", "4"], "-", 
     SuperscriptBox["x", "5"], "-", 
     SuperscriptBox["x", "6"], "+", 
     SuperscriptBox["x", "8"]}], ",", 
    RowBox[{"1", "-", 
     SuperscriptBox["x", "3"], "-", 
     SuperscriptBox["x", "4"], "-", 
     SuperscriptBox["x", "5"], "+", 
     SuperscriptBox["x", "8"]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.444842786089473*^9, 3.444842786347292*^9}, {
  3.44491750738793*^9, 3.444917510259004*^9}}],

Cell[BoxData[{
 RowBox[{"s", "=", 
  RowBox[{"OrientableStrataList", "[", "4", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "s", "]"}]}], "Input",
 CellChangeTimes->{{3.444842792866845*^9, 3.444842793083111*^9}}],

Cell[BoxData[
 RowBox[{"fulltreatment", "[", 
  RowBox[{"P", ",", "s"}], "]"}]], "Input",
 CellChangeTimes->{
  3.444843027152232*^9, {3.444846203074746*^9, 3.444846212021202*^9}}],

Cell[BoxData[
 RowBox[{"fulltreatment", "[", 
  RowBox[{
   RowBox[{"P", "/.", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", "x"}]}]}], ",", "s"}], "]"}]], "Input",
 CellChangeTimes->{{3.444842950958647*^9, 3.4448429524069147`*^9}, 
   3.444843151522685*^9, 3.444846216618888*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["genus 5", "Subsection",
 CellChangeTimes->{{3.4448420185167427`*^9, 3.444842028138886*^9}, {
   3.444842246772585*^9, 3.444842246889783*^9}, 3.444844145883678*^9}],

Cell[CellGroupData[{

Cell["Lehmer", "Subsubsection",
 CellChangeTimes->{{3.44484329030623*^9, 3.444843291036153*^9}}],

Cell["Now try the Lehmer polynomial for genus 5 :", "Text",
 CellChangeTimes->{{3.444733611399207*^9, 3.444733620310625*^9}, {
  3.444920386570821*^9, 3.4449203880949163`*^9}}],

Cell[BoxData[
 RowBox[{"P", "=", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["x", "10"], "+", 
    SuperscriptBox["x", "9"], "-", 
    SuperscriptBox["x", "7"], "-", 
    SuperscriptBox["x", "6"], "-", 
    SuperscriptBox["x", "5"], "-", 
    SuperscriptBox["x", "4"], "-", 
    SuperscriptBox["x", "3"], "+", "x", "+", "1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.4444261520862913`*^9, 3.444426152806209*^9}, {
  3.444821705830997*^9, 3.444821709749008*^9}}],

Cell[BoxData[{
 RowBox[{"s", "=", 
  RowBox[{"OrientableStrataList", "[", "5", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "s", "]"}]}], "Input",
 CellChangeTimes->{{3.4444281370424843`*^9, 3.444428137143355*^9}, {
  3.444734938374177*^9, 3.444734938710763*^9}}],

Cell["For the positive Perron root, there are no possible strata :", "Text",
 CellChangeTimes->{{3.444733630512706*^9, 3.444733663871092*^9}}],

Cell[BoxData[
 RowBox[{"fulltreatment", "[", 
  RowBox[{"P", ",", "s", ",", " ", 
   RowBox[{"MaxLefschetz", "\[Rule]", "150"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4448229370897512`*^9, 3.444822964752674*^9}}],

Cell["\<\
For the negative case, should be left with (16) and (4,4,4,4):\
\>", "Text",
 CellChangeTimes->{{3.444733650930694*^9, 3.444733684749897*^9}}],

Cell[BoxData[
 RowBox[{"fulltreatment", "[", 
  RowBox[{
   RowBox[{"P", "/.", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", "x"}]}]}], ",", "s", ",", " ", 
   RowBox[{"MaxLefschetz", "\[Rule]", "150"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.444822981162518*^9, 3.44482298255271*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dilatation between Lehmer and \"old\" minimizer", "Subsubsection",
 CellChangeTimes->{{3.44484343659243*^9, 3.444843452444718*^9}}],

Cell["\<\
These are the cases between Lehmer and our \"old\" minimizer  for genus 5:\
\>", "Text",
 CellChangeTimes->{{3.444757177166217*^9, 3.44475720356868*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["x", "2"], "-", 
        SuperscriptBox["x", "5"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "3"], "-", 
        SuperscriptBox["x", "5"]}], ")"}]}], ",", 
     RowBox[{"1", "+", "x", "-", 
      SuperscriptBox["x", "2"], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "3"]}], "+", 
      SuperscriptBox["x", "5"], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "7"]}], "-", 
      SuperscriptBox["x", "8"], "+", 
      SuperscriptBox["x", "9"], "+", 
      SuperscriptBox["x", "10"]}], ",", 
     RowBox[{"1", "-", 
      SuperscriptBox["x", "4"], "-", 
      SuperscriptBox["x", "5"], "-", 
      SuperscriptBox["x", "6"], "+", 
      SuperscriptBox["x", "10"]}], ",", 
     RowBox[{"1", "-", 
      SuperscriptBox["x", "3"], "-", 
      SuperscriptBox["x", "5"], "-", 
      SuperscriptBox["x", "7"], "+", 
      SuperscriptBox["x", "10"]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["x", "5"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        SuperscriptBox["x", "3"], "+", 
        SuperscriptBox["x", "5"]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "x", "+", 
        SuperscriptBox["x", "2"], "-", 
        SuperscriptBox["x", "3"], "-", 
        SuperscriptBox["x", "5"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["x", "2"], "-", 
        SuperscriptBox["x", "3"], "+", 
        SuperscriptBox["x", "4"], "-", 
        SuperscriptBox["x", "5"]}], ")"}]}], ",", 
     RowBox[{"1", "+", "x", "-", 
      SuperscriptBox["x", "3"], "-", 
      SuperscriptBox["x", "4"], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "5"]}], "-", 
      SuperscriptBox["x", "6"], "-", 
      SuperscriptBox["x", "7"], "+", 
      SuperscriptBox["x", "9"], "+", 
      SuperscriptBox["x", "10"]}], ",", 
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"], "-", 
      SuperscriptBox["x", "5"], "-", 
      SuperscriptBox["x", "8"], "+", 
      SuperscriptBox["x", "10"]}], ",", 
     RowBox[{"1", "-", "x", "+", 
      SuperscriptBox["x", "2"], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "4"]}], "+", 
      SuperscriptBox["x", "5"], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "6"]}], "+", 
      SuperscriptBox["x", "8"], "-", 
      SuperscriptBox["x", "9"], "+", 
      SuperscriptBox["x", "10"]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.444757031106664*^9, 3.444757051284956*^9}, 
   3.4448218960086393`*^9}],

Cell[BoxData[
 RowBox[{"fulltreatment", "[", 
  RowBox[{"P", ",", "s", ",", " ", 
   RowBox[{"MaxLefschetz", "\[Rule]", "150"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4448229370897512`*^9, 3.444822964752674*^9}, {
   3.444823014841474*^9, 3.444823015673218*^9}, 3.444843874722116*^9, {
   3.444844582878237*^9, 3.444844583347602*^9}, 3.444846253546895*^9, {
   3.445264148868692*^9, 3.445264149860657*^9}, 3.445457695287043*^9}],

Cell[BoxData[
 RowBox[{"fulltreatment", "[", 
  RowBox[{
   RowBox[{"P", "/.", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", "x"}]}]}], ",", "s", ",", " ", 
   RowBox[{"MaxLefschetz", "\[Rule]", "150"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4448229370897512`*^9, 3.444822964752674*^9}, {
   3.444823029157939*^9, 3.444823032313073*^9}, 3.4448438800874166`*^9, 
   3.444846279578603*^9, {3.445264163764492*^9, 3.445264164516682*^9}, {
   3.445457634880376*^9, 3.445457648340706*^9}, {3.445457679934524*^9, 
   3.44545768059099*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["genus 6", "Subsection",
 CellChangeTimes->{{3.444843463942903*^9, 3.444843466935066*^9}, 
   3.444844148531447*^9}],

Cell["\<\
The \"Lehmer\" cases for genus 6 :\
\>", "Text",
 CellChangeTimes->{{3.444659296727528*^9, 3.444659304500119*^9}, {
  3.4449620651368*^9, 3.4449620667811527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "x"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x", "-", 
        SuperscriptBox["x", "3"], "-", 
        SuperscriptBox["x", "4"], "-", 
        SuperscriptBox["x", "5"], "-", 
        SuperscriptBox["x", "6"], "-", 
        SuperscriptBox["x", "7"], "+", 
        SuperscriptBox["x", "9"], "+", 
        SuperscriptBox["x", "10"]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "x", "+", 
        SuperscriptBox["x", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x", "-", 
        SuperscriptBox["x", "3"], "-", 
        SuperscriptBox["x", "4"], "-", 
        SuperscriptBox["x", "5"], "-", 
        SuperscriptBox["x", "6"], "-", 
        SuperscriptBox["x", "7"], "+", 
        SuperscriptBox["x", "9"], "+", 
        SuperscriptBox["x", "10"]}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x", "-", 
        SuperscriptBox["x", "3"], "-", 
        SuperscriptBox["x", "4"], "-", 
        SuperscriptBox["x", "5"], "-", 
        SuperscriptBox["x", "6"], "-", 
        SuperscriptBox["x", "7"], "+", 
        SuperscriptBox["x", "9"], "+", 
        SuperscriptBox["x", "10"]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["x", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x", "-", 
        SuperscriptBox["x", "3"], "-", 
        SuperscriptBox["x", "4"], "-", 
        SuperscriptBox["x", "5"], "-", 
        SuperscriptBox["x", "6"], "-", 
        SuperscriptBox["x", "7"], "+", 
        SuperscriptBox["x", "9"], "+", 
        SuperscriptBox["x", "10"]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "x", "+", 
        SuperscriptBox["x", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x", "-", 
        SuperscriptBox["x", "3"], "-", 
        SuperscriptBox["x", "4"], "-", 
        SuperscriptBox["x", "5"], "-", 
        SuperscriptBox["x", "6"], "-", 
        SuperscriptBox["x", "7"], "+", 
        SuperscriptBox["x", "9"], "+", 
        SuperscriptBox["x", "10"]}], ")"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.444659123217706*^9, 3.444659172932392*^9}, 
   3.444659309874596*^9, 3.4448219367172318`*^9}],

Cell[BoxData[{
 RowBox[{"s", "=", 
  RowBox[{"OrientableStrataList", "[", "6", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "s", "]"}]}], "Input",
 CellChangeTimes->{{3.444733458599819*^9, 3.444733458915876*^9}, {
  3.444734931716041*^9, 3.444734931957156*^9}}],

Cell[BoxData[
 RowBox[{"fulltreatment", "[", 
  RowBox[{"P", ",", "s", ",", " ", 
   RowBox[{"MaxLefschetz", "\[Rule]", "200"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4448229370897512`*^9, 3.444822964752674*^9}, {
   3.444823014841474*^9, 3.444823015673218*^9}, {3.4448230767107964`*^9, 
   3.4448230768921137`*^9}, 3.4448238185923223`*^9, 3.44484630337877*^9, {
   3.4454577125214443`*^9, 3.44545771284864*^9}}],

Cell[BoxData[
 RowBox[{"fulltreatment", "[", 
  RowBox[{
   RowBox[{"P", "/.", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", "x"}]}]}], ",", "s", ",", 
   RowBox[{"MaxIterate", "\[Rule]", "3"}], ",", " ", 
   RowBox[{"MaxLefschetz", "\[Rule]", "200"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.444823110516636*^9, 3.444823115414341*^9}, 
   3.444823823123805*^9, {3.444846335803677*^9, 3.444846336772005*^9}, {
   3.4449343935856323`*^9, 3.4449343955515327`*^9}, {3.4454577393255653`*^9, 
   3.445457749543131*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1042, 750},
WindowMargins->{{33, Automatic}, {Automatic, 86}},
ShowSelection->True,
FrontEndVersion->"7.0 for Linux x86 (64-bit) (November 11, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 117, 1, 53, "Subtitle"],
Cell[CellGroupData[{
Cell[709, 27, 99, 1, 73, "Section"],
Cell[811, 30, 199, 4, 32, "Input"],
Cell[1013, 36, 348, 6, 32, "Input"],
Cell[1364, 44, 1078, 25, 99, "Input"],
Cell[2445, 71, 3837, 85, 231, "Input"],
Cell[6285, 158, 2730, 60, 143, "Input"],
Cell[9018, 220, 3536, 82, 187, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[12591, 307, 148, 2, 43, "Section"],
Cell[CellGroupData[{
Cell[12764, 313, 219, 3, 39, "Subsection"],
Cell[CellGroupData[{
Cell[13008, 320, 116, 1, 29, "Subsubsection"],
Cell[13127, 323, 337, 6, 51, "Text"],
Cell[13467, 331, 947, 29, 32, "Input"],
Cell[14417, 362, 468, 8, 55, "Input"],
Cell[14888, 372, 247, 5, 31, "Text"],
Cell[15138, 379, 338, 6, 32, "Input"],
Cell[15479, 387, 196, 4, 31, "Text"],
Cell[15678, 393, 234, 6, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15949, 404, 167, 3, 29, "Subsubsection"],
Cell[16119, 409, 128, 1, 31, "Text"],
Cell[16250, 412, 2380, 72, 55, "Input"],
Cell[18633, 486, 224, 4, 55, "Input"],
Cell[18860, 492, 180, 4, 32, "Input"],
Cell[19043, 498, 282, 7, 32, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19374, 511, 241, 3, 39, "Subsection"],
Cell[CellGroupData[{
Cell[19640, 518, 112, 1, 29, "Subsubsection"],
Cell[19755, 521, 2122, 63, 55, "Input"],
Cell[21880, 586, 224, 4, 55, "Input"],
Cell[22107, 592, 180, 4, 32, "Input"],
Cell[22290, 598, 282, 7, 32, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22621, 611, 169, 2, 39, "Subsection"],
Cell[CellGroupData[{
Cell[22815, 617, 96, 1, 29, "Subsubsection"],
Cell[22914, 620, 176, 2, 31, "Text"],
Cell[23093, 624, 466, 12, 32, "Input"],
Cell[23562, 638, 275, 5, 55, "Input"],
Cell[23840, 645, 142, 1, 31, "Text"],
Cell[23985, 648, 215, 4, 32, "Input"],
Cell[24203, 654, 152, 3, 31, "Text"],
Cell[24358, 659, 289, 7, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24684, 671, 137, 1, 29, "Subsubsection"],
Cell[24824, 674, 163, 3, 31, "Text"],
Cell[24990, 679, 2812, 82, 77, "Input"],
Cell[27805, 763, 431, 7, 32, "Input"],
Cell[28239, 772, 537, 11, 32, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28825, 789, 121, 2, 39, "Subsection"],
Cell[28949, 793, 173, 4, 31, "Text"],
Cell[29125, 799, 2517, 71, 77, "Input"],
Cell[31645, 872, 273, 5, 55, "Input"],
Cell[31921, 879, 415, 7, 32, "Input"],
Cell[32339, 888, 517, 11, 32, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
